var DragMoveModel=function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e=function(){});var n=this;this.startX=0,this.startY=0,this.moveInsX=0,this.moveInsY=0,this.isMousedown=!1,this.targetEl=null,this.targetElTx=0,this.targetElTy=0,this.initTargetElTop=0,this.initTargetElLeft=0,this.limitMoveBorder=!1,this.moveMode="transform",this.callback=null,this.h5=!1,this.disableMoveEl=!1,this.maxMoveX=1e6,this.maxMoveY=1e6,this.rootDom=document,this._calcTargetTranlate=function(){var t,e;n.targetEl&&-1<(t=n._getStyleTransformProp(n.targetEl.style.transform,"translate3d")).indexOf("translate3d")&&(e=(t=(e=/\((.*)\)/g.exec(t))?e[1].replace(/, /g,","):t).replace("(","").replace(")","").split(","),n.targetElTx=+e[0].replace("px","")||0,n.targetElTy=+e[1].replace("px","")||0)},this._topLeftMoveTargetEl=function(){var t,e,o=n.moveInsX+n.initTargetElLeft,i=n.moveInsY+n.initTargetElTop;n.limitMoveBorder&&(t=n.targetEl.getBoundingClientRect(),e=t.width,t=t.height,(i=i<0?0:i)>window.innerHeight-t&&(i=window.innerHeight-t),(o=o<0?0:o)>window.innerWidth-e)&&(o=window.innerWidth-e),n.targetEl.style.left=o+"px",n.targetEl.style.top=i+"px"},this._mousemoveHandler=function(t){var e=(n.h5?t.changedTouches[0]:t).pageX,t=(n.h5?t.changedTouches[0]:t).pageY;n.isMousedown&&(e<n.startX&&(n.moveInsX=n.moveInsX>-n.maxMoveX?e-n.startX:-n.maxMoveX),e>n.startX&&(n.moveInsX=n.moveInsX<n.maxMoveX?e-n.startX:n.maxMoveX),t<n.startY&&(n.moveInsY=n.moveInsY>-n.maxMoveY?t-n.startY:-n.maxMoveY),t>n.startY&&(n.moveInsY=n.moveInsY<n.maxMoveY?t-n.startY:n.maxMoveY),n.disableMoveEl||("position"===n.moveMode?n._topLeftMoveTargetEl():n._translateMoveEl()),e=Math.round(Math.pow(n.moveInsX*n.moveInsX+n.moveInsY*n.moveInsY,.5)),n.callback(n.moveInsX,n.moveInsY,e))},this._mousedownHandler=function(t){var e=(n.h5?t.changedTouches[0]:t).pageX,t=(n.h5?t.changedTouches[0]:t).pageY;n.startX=e,n.startY=t,n.moveInsX=0,n.moveInsY=0,n.isMousedown=!0,n._calcTargetTranlate(),"position"===n.moveMode&&n._initTragetElInfo()},this._mouseupHandler=function(t){n.isMousedown=!1,n.startX=0,n.startY=0},this._initConfig(t),this._initEvent(),this._initTragetElInfo(),this.callback=e}return t.prototype._initConfig=function(t){this.targetEl=t.targetEl||this.rootDom.body,this.limitMoveBorder=!!t.limitMoveBorder,this.moveMode=t.moveMode||"transform",this.h5=!!t.h5,this.disableMoveEl=!!t.disableMoveEl,this.maxMoveX=t.maxMoveX||this.maxMoveX,this.maxMoveY=t.maxMoveY||this.maxMoveY,this.rootDom=t.rootDom||this.rootDom},t.prototype._initTragetElInfo=function(){var t,e;this.targetEl&&(t=(e=this.targetEl.getBoundingClientRect()).top,e=e.left,this.initTargetElTop=t,this.initTargetElLeft=e,this.targetEl.style["will-change"]="transform"===this.moveMode?"transform":"left, top")},t.prototype._getStyleTransformProp=function(t,e){void 0===e&&(e="scale");var t=(t=(t=void 0===t?"":t).replace(/, /g,",").trim()).split(" "),o="";return t.forEach(function(t){-1<t.indexOf(e)&&(o=t)}),o},t.prototype._setTransformProp=function(t,e,o){void 0===t&&(t=""),void 0===e&&(e=""),void 0===o&&(o="");var i=new RegExp("".concat(e,"((.*))"),"g");return t=-1<t.indexOf(e)?t.replace(/, /g,",").trim().split(" ").map(function(t){return t.replace(i,"".concat(e,"(").concat(o,")"))}).join(" "):"".concat(e,"(").concat(o,") ")+t},t.prototype._translateMoveEl=function(){var t,e,o,i,n=this;this.targetEl&&(t=this.targetElTx+this.moveInsX,e=this.targetElTy+this.moveInsY,this.limitMoveBorder&&(o=n.targetEl.getBoundingClientRect(),i=o.width,o=o.height,(t=t+i+n.initTargetElLeft>window.innerWidth?window.innerWidth-i-n.initTargetElLeft:t)<-n.initTargetElLeft&&(t=-n.initTargetElLeft),(e=e+o+n.initTargetElTop>window.innerHeight?window.innerHeight-o-n.initTargetElTop:e)<-n.initTargetElTop)&&(e=-n.initTargetElTop),i=(i=this.targetEl.style.transform)?this._setTransformProp(i,"translate3d","".concat(t,"px, ").concat(e,"px, 0px")):"translate3d(".concat(t,"px, ").concat(e,"px, 0px)"),this.targetEl.style.transform=i)},t.prototype._initEvent=function(){var t=this.h5?"touchmove":"mousemove",e=this.h5?"touchstart":"mousedown",o=this.h5?"touchend":"mouseup";this.rootDom.addEventListener(t,this._mousemoveHandler),this.targetEl&&this.targetEl.addEventListener(e,this._mousedownHandler),this.rootDom.addEventListener(o,this._mouseupHandler)},t.prototype.destroy=function(){var t=this.h5?"touchmove":"mousemove",e=this.h5?"touchstart":"mousedown",o=this.h5?"touchend":"mouseup";this.targetEl&&this.targetEl.removeEventListener(t,this._mousedownHandler),this.rootDom.removeEventListener(e,this._mousemoveHandler),this.rootDom.removeEventListener(o,this._mouseupHandler)},t}();export default DragMoveModel;